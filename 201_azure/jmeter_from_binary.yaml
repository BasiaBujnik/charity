trigger: none
pool:
  vmImage: 'ubuntu-latest'

variables:
  jmxFile: 'test.jmx'
  jmeterVersion: 'apache-jmeter-5.4.1'

stages:
  - stage: JMeter
    displayName: Run JMeter from binary
    jobs:
      - job: Jmeter
        displayName: Test
        steps:
          - bash: |
              #Download JMeter
              curl -O -L -X GET https://mirrors.ocf.berkeley.edu/apache/jmeter/binaries/$(jmeterVersion).zip
              #Unzip
              unzip $(jmeterVersion).zip
            displayName: Download JMeter

          - bash: |
              mkdir -p html
              sh $(jmeterVersion)/bin/jmeter.sh -n -t 201_azure/$(jmxFile) -j jmeter.log -l results.csv -e -o html
              ls -alh
            displayName: Run Test

